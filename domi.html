<!doctype html>
<html lang="de">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Dommis wunderbares Abenteuer ğŸŒŠğŸ‰</title>
<meta name="description" content="Ãœberraschungs-Geschenkseite mit fÃ¼nf RÃ¤tseln ğŸ§©. Erst nach dem LÃ¶sen erscheint der Gutschein ğŸ." />
<style>
  :root{--bg:#0e2a47;--fg:#ffffff;--accent:#00c2ff;--accent2:#ffd166;--ok:#51d88a;--warn:#ff6b6b;--ink:#0b1b2b;--card:#122f50}
  *{box-sizing:border-box}
  html,body{margin:0;padding:0;background:linear-gradient(180deg,#0e2a47 0%, #0a223b 55%, #081b30 100%);
    color:var(--fg);font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif}
  a{color:var(--accent)}
  header{position:relative;text-align:center;padding:64px 24px 32px;overflow:hidden;isolation:isolate}
  header h1{font-size:clamp(2rem,6vw,4rem);margin:0;line-height:1.05;letter-spacing:.01em;text-shadow:0 8px 24px rgba(0,0,0,.35)}
  header p.lead{margin:16px auto 0;max-width:820px;font-size:clamp(1.05rem,2.3vw,1.35rem);opacity:.95}
  .wave{position:absolute;left:0;right:0;bottom:-1px;height:120px;background:
    radial-gradient(circle at 10% 40%,#0f3357 0 12%,transparent 13%),
    radial-gradient(circle at 30% 60%,#0f3357 0 14%,transparent 15%),
    radial-gradient(circle at 60% 45%,#0f3357 0 13%,transparent 14%),
    radial-gradient(circle at 85% 70%,#0f3357 0 12%,transparent 13%);opacity:.8;filter:blur(2px)}
  main{padding:24px}
  .container{max-width:1100px;margin-inline:auto}
  .card{background:color-mix(in srgb,var(--card) 92%,#fff 8%);border:1px solid color-mix(in srgb,var(--accent) 15%,#000 85%);
    border-radius:18px;padding:24px;box-shadow:0 12px 40px rgba(0,0,0,.25);backdrop-filter:blur(4px)}
  .grid{display:grid;gap:24px;grid-template-columns:repeat(auto-fit,minmax(280px,1fr))}
  h2{margin:0 0 12px;font-size:clamp(1.4rem,3vw,2rem)}
  h3{margin:0 0 8px}
  .badge{display:inline-block;padding:6px 12px;border-radius:999px;background:#073356;color:#ccefff;font-size:.95rem;border:1px solid #0e5581}
  .puzzle{position:relative;border-left:4px solid var(--accent);padding:24px;background:#0c2743;border-radius:12px}
  .puzzle.solved{border-left-color:var(--ok);background:#0f304f}
  .status{margin-top:10px;font-weight:600}
  .status.ok{color:var(--ok)}
  .status.err{color:var(--warn)}
  .input-row{display:flex;gap:12px;flex-wrap:wrap}
  input[type="text"],input[type="number"]{background:#092540;border:1px solid #184f73;color:var(--fg);border-radius:10px;padding:12px 14px;font-size:1rem;min-width:220px;outline:none}
  button{border:none;border-radius:12px;padding:12px 18px;font-weight:600;cursor:pointer;background:linear-gradient(90deg,var(--accent) 0%,#4dd8ff 100%);color:#002033;box-shadow:0 8px 24px rgba(0,0,0,.25)}
  button.secondary{background:#0f3a5f;color:#d7f4ff;border:1px solid #1a638f;box-shadow:none}
  button:disabled{opacity:.55;cursor:not-allowed}
  .symbols{font-size:2rem;line-height:1.4;display:flex;flex-wrap:wrap;gap:12px;margin:12px 0}
  .symbols span{filter:drop-shadow(0 4px 8px rgba(0,0,0,.35))}
  #voucher{margin-top:24px;position:relative;overflow:hidden;border:2px dashed #2a6a8f;border-radius:18px;background:#0a233b}
  #voucher h2{font-size:1.8rem}
  .stamp{position:absolute;right:-24px;top:-24px;rotate:-15deg;width:200px;aspect-ratio:1/1;border-radius:50%;
    border:6px solid #ffd166;color:#ffd166;display:grid;place-items:center;font-weight:800;text-align:center;
    text-transform:uppercase;letter-spacing:.08em;background:transparent;mix-blend-mode:screen;opacity:.9}
  .stamp small{display:block;font-weight:600;letter-spacing:.15em}
  .lock{padding:16px;border-radius:12px;background:#0d2946;border:1px solid #184f73;margin-top:12px;text-align:center}
  .content{display:none}
  .content.show{display:block}
  #voucher .content-inner{padding:28px;display:grid;gap:16px;grid-template-columns:1.1fr 0.9fr}
  .voucher-list li{margin:6px 0}
  .controls{display:flex;gap:12px;flex-wrap:wrap;margin-top:16px}
  #confetti{position:fixed;inset:0;pointer-events:none;z-index:999}
  footer{text-align:center;opacity:.75;font-size:.95rem;padding:40px 16px 64px}
  @media (max-width:780px){#voucher .content-inner{grid-template-columns:1fr}.stamp{width:160px}}
  @media print{
    body{background:#fff;color:#000}
    header,.lock,.controls,#confetti{display:none !important}
    .card,.puzzle,#voucher{box-shadow:none;border-color:#999;background:#fff;color:#000}
    #voucher{border-style:solid}
    a{color:#000;text-decoration:underline}
  }
</style>
</head>
<body>
<canvas id="confetti"></canvas>

<header>
  <h1>Dommis wunderbares Abenteuer ğŸŒŠğŸ§­</h1>
  <p class="lead">FÃ¼nf RÃ¤tsel ğŸ§© warten. Erst wenn alle gelÃ¶st sind âœ…, zeigt sich das Ziel samt Gutschein ğŸâœ¨.</p>
  <div class="wave" aria-hidden="true"></div>
</header>

<main>
  <div class="container">
    <section class="card" aria-labelledby="intro-title">
      <h2 id="intro-title">Ahoi, Dommi! âš“ï¸ğŸ˜</h2>
      <p>Es geht aufâ€™s Wasser ğŸš£â€â™€ï¸ â€“ mehr wird noch nicht verraten ğŸ¤«. LÃ¶se die RÃ¤tsel und lÃ¼fte das Geheimnis ğŸ—ï¸.</p>
      <span class="badge">5 RÃ¤tsel Â· 1 Abenteuer ğŸš€</span>
    </section>

    <section class="grid" style="margin-top:24px">
      <!-- 1: Musik -->
      <article class="puzzle" id="puzzle1" aria-labelledby="p1-title">
        <h3 id="p1-title">RÃ¤tsel 1 â€“ MusikrÃ¤tsel ğŸ¶</h3>
        <p><strong>Welches Lied ist gesucht?</strong> ğŸºğŸ§‘â€âœˆï¸</p>
        <div class="input-row">
          <input id="word" type="text" autocomplete="off" placeholder="Titel eingeben â€¦" />
          <button id="check1">PrÃ¼fen âœ…</button>
        </div>
        <div id="status1" class="status" aria-live="polite"></div>
      </article>

      <!-- 2: Symbolcode -->
      <article class="puzzle" id="puzzle2" aria-labelledby="p2-title">
        <h3 id="p2-title">RÃ¤tsel 2 â€“ Symbolcode ğŸ”¢</h3>
        <p>Bestimme die vierstellige Zahl in der Reihenfolge: ğŸ¦† â†’ ğŸ›¶ â†’ ğŸ›Ÿ â†’ ğŸŒŠ.</p>
        <div class="symbols" aria-hidden="true" id="symbolField">
          <span class="waveSymbol">ğŸŒŠğŸŒŠ</span>
          <span class="duck">ğŸ¦†</span>
          <span class="paddle">ğŸ›¶</span>
          <span class="duck">ğŸ¦†</span>
          <span class="ring">ğŸ›Ÿ</span>
          <span class="waveSymbol">ğŸŒŠ</span>
          <span class="paddle">ğŸ›¶</span>
          <span class="waveSymbol">ğŸŒŠğŸŒŠğŸŒŠ</span>
          <span class="duck">ğŸ¦†</span>
          <span class="waveSymbol">ğŸŒŠ</span>
        </div>
        <div class="input-row">
          <input id="code" type="text" inputmode="numeric" maxlength="4" placeholder="Antwort eingeben â€¦" />
          <button id="check2">PrÃ¼fen âœ…</button>
        </div>
        <div id="status2" class="status" aria-live="polite"></div>
      </article>

      <!-- 3: Basel -->
      <article class="puzzle" id="puzzle3" aria-labelledby="p3-title">
        <h3 id="p3-title">RÃ¤tsel 3 â€“ Analysis I (Basel-Reihe) ğŸ§®</h3>
        <p>Bestimme die exakte Summe <strong>S = âˆ‘<sub>n=1</sub><sup>âˆ</sup> 1/nÂ²</strong> âœ¨.</p>
        <p>Antworte als exakter Ausdruck oder als Zahl (Toleranz 1eâˆ’6).</p>
        <div class="input-row">
          <input id="sumInput" type="text" autocomplete="off" placeholder="Antwort eingeben â€¦" />
          <button id="check3">PrÃ¼fen âœ…</button>
        </div>
        <div id="status3" class="status" aria-live="polite"></div>
      </article>

      <!-- 4: Îµâ€“Î´ -->
      <article class="puzzle" id="puzzle4" aria-labelledby="p4-title">
        <h3 id="p4-title">RÃ¤tsel 4 â€“ Îµâ€“Î´-Aufgabe ğŸ“</h3>
        <p>FÃ¼r <strong>f(x)=3x+1</strong> gilt <strong>lim<sub>xâ†’2</sub> f(x) = 7</strong>. Gib eine gÃ¼ltige Wahl <strong>Î´(Îµ)</strong> an,
           sodass aus <strong>|xâˆ’2| &lt; Î´</strong> stets <strong>|f(x)âˆ’7| &lt; Îµ</strong> folgt.</p>
        <div class="input-row">
          <input id="deltaFormula" type="text" placeholder="Formel eingeben â€¦" />
          <button id="check4f">Formel prÃ¼fen âœ…</button>
        </div>
        <div class="input-row" style="margin-top:8px">
          <input id="epsNum" type="text" placeholder="Îµ > 0" />
          <input id="deltaNum" type="text" placeholder="Î´ > 0" />
          <button id="check4n">Numerisch prÃ¼fen ğŸ§ª</button>
        </div>
        <div id="status4" class="status" aria-live="polite"></div>
      </article>

      <!-- 5: Kfz -->
      <article class="puzzle" id="puzzle5" aria-labelledby="p5-title">
        <h3 id="p5-title">RÃ¤tsel 5 â€“ Kfz-Bremssysteme ğŸš—ğŸ› ï¸</h3>
        <p>Wodurch wird der <strong>BremskraftverstÃ¤rker (BKV)</strong> typischerweise mit Unterdruck versorgt?</p>
        <form id="kfzForm">
          <label style="display:block;margin:6px 0"><input type="radio" name="kfz" value="A"> A) Otto: Saugrohrunterdruck Â· Diesel: Vakuumpumpe.</label>
          <label style="display:block;margin:6px 0"><input type="radio" name="kfz" value="B"> B) Beide ausschlieÃŸlich durch Saugrohrunterdruck.</label>
          <label style="display:block;margin:6px 0"><input type="radio" name="kfz" value="C"> C) Beide ausschlieÃŸlich Ã¼ber den Turbolader.</label>
          <label style="display:block;margin:6px 0"><input type="radio" name="kfz" value="D"> D) Otto: Vakuumpumpe Â· Diesel: Saugrohrunterdruck.</label>
        </form>
        <div class="input-row" style="margin-top:8px">
          <button id="check5">PrÃ¼fen âœ…</button>
        </div>
        <div id="status5" class="status" aria-live="polite"></div>
      </article>
    </section>

    <!-- Gutschein -->
    <section id="voucher" class="card" aria-labelledby="voucher-title">
      <div class="stamp" aria-hidden="true"><div>Gutschein ğŸŸï¸<br><small>fÃ¼r Dommi ğŸ’™</small></div></div>
      <h2 id="voucher-title">Der Gutschein ğŸ</h2>
      <div class="lock" id="lock"><p>Versiegelt ğŸ”’. LÃ¶se alle fÃ¼nf RÃ¤tsel, um alles aufzudecken âœ¨.</p></div>
      <div id="voucherContent" class="content" aria-hidden="true"></div>
    </section>

    <!-- Editor -->
    <section id="editor" class="card" style="display:none;margin-top:24px" aria-labelledby="edit-title">
      <h3 id="edit-title">Details bearbeiten âœï¸</h3>
      <div class="grid">
        <label>Datum ğŸ“…<br><input id="e_datum" type="text" value="16.08.2025"></label>
        <label>Uhrzeit â°<br><input id="e_uhr" type="text" placeholder=""></label>
        <label>Treffpunkt ğŸ“<br><input id="e_ort" type="text" value="Isarufer, MÃ¼nchen (genauer Treffpunkt folgt)"></label>
        <label>Route ğŸ—ºï¸<br><input id="e_route" type="text" value="Isar in MÃ¼nchen â€“ Abschnitt nach Absprache"></label>
        <label>Dauer â³<br><input id="e_dauer" type="text" value="ca. 3â€“5 Stunden inklusive Pause"></label>
        <label>Mitbringen ğŸ’<br><input id="e_mitbringen" type="text" value="Sonnencreme, Wasser, Handtuch, Sonnenbrille, ggf. Wechselsachen"></label>
        <label>Verpflegung ğŸ¥ªğŸ¥¤<br><input id="e_snacks" type="text" value="Picknick & GetrÃ¤nke organisieren wir ğŸ’"></label>
        <label>Wetter-Backup â˜”ï¸<br><input id="e_backup" type="text" value="Bei Starkregen/Unwetter verschieben wir."></label>
        <label>Kontakt ğŸ“<br><input id="e_kontakt" type="text" placeholder=""></label>
      </div>
      <div class="controls">
        <button id="saveBtn">Speichern ğŸ’¾</button>
        <button id="cancelBtn" class="secondary" type="button">Abbrechen â†©ï¸</button>
      </div>
      <p style="opacity:.8">Hinweis: Daten werden nur lokal im Browser gespeichert ğŸ’».</p>
    </section>
  </div>
</main>

<footer>Gemacht mit ğŸ’™ fÃ¼r Dommi â€“ bis bald an der Isar ğŸŒğŸŒŠ.</footer>

<template id="voucherTpl">
  <div class="content-inner">
    <div>
      <p>GroÃŸartig! Geheimnis gelÃ¼ftet ğŸ‰: Es geht auf eine <strong>Schlauchboottour</strong>! ğŸš¤ğŸŒŠ</p>
      <ul class="voucher-list gift-info">
        <li>ğŸ“… <strong>Datum:</strong> <span id="v_datum">16.08.2025</span></li>
        <li>â° <strong>Uhrzeit:</strong> <span id="v_uhr">HH:MM</span></li>
        <li>ğŸ“ <strong>Treffpunkt:</strong> <span id="v_ort">Isarufer, MÃ¼nchen (genauer Treffpunkt folgt)</span></li>
        <li>ğŸ—ºï¸ <strong>Route:</strong> <span id="v_route">Isar in MÃ¼nchen â€“ Abschnitt nach Absprache</span></li>
        <li>â³ <strong>Dauer:</strong> <span id="v_dauer">ca. 3â€“5 Stunden inklusive Pause</span></li>
        <li>ğŸ§´ğŸ•¶ï¸ <strong>Mitbringen:</strong> <span id="v_mitbringen">Sonnencreme, Wasser, Handtuch, Sonnenbrille, ggf. Wechselsachen</span></li>
        <li>ğŸ¥ªğŸ¥¤ <strong>Verpflegung:</strong> <span id="v_snacks">Picknick & GetrÃ¤nke organisieren wir ğŸ’</span></li>
        <li>â˜”ï¸ <strong>Wetter-Backup:</strong> <span id="v_backup">Bei Starkregen/Unwetter verschieben wir.</span></li>
        <li>ğŸ“ <strong>Kontakt:</strong> <span id="v_kontakt">[Name + Telefonnummer]</span></li>
      </ul>
    </div>
    <div>
      <div class="controls">
        <button id="printBtn" class="secondary" type="button">Gutschein drucken ğŸ–¨ï¸</button>
        <button id="editBtn" class="secondary" type="button">Details anpassen âœï¸</button>
      </div>
    </div>
  </div>
</template>

<script>
(function(){
  const EXPECTED_R1_RAW = "BIERKAPITÃ„N";
  const EXPECTED_R1_ASCII = "BIERKAPITAN";
  const EXPECTED_R1_AE = "BIERKAPITAEN";

  const EXPECTED_CODE = "3214";
  const TARGET_NUM = Math.PI*Math.PI/6;
  const TOL = 1e-6;

  let solved1=false, solved2=false, solved3=false, solved4=false, solved5=false, inserted=false;
  const $ = sel => document.querySelector(sel);

  // R1 â€“ Musik
  $("#check1").addEventListener("click", () => {
    const raw = $("#word").value.trim().toUpperCase().replace(/\s+/g,'');
    const nodiac = raw.normalize('NFD').replace(/[\u0300-\u036f]/g,'');
    const status = $("#status1");
    if(raw === EXPECTED_R1_RAW || nodiac === EXPECTED_R1_ASCII || raw === EXPECTED_R1_AE){
      solved1 = true; $("#puzzle1").classList.add("solved");
      status.textContent = "Richtig! ğŸ¯"; status.className = "status ok";
      celebrate(); unlockIfReady();
    }else{
      status.textContent = "Nicht korrekt ğŸ™ˆ."; status.className = "status err";
    }
  });

  // R2 â€“ Symbolcode
  $("#check2").addEventListener("click", ()=>{
    const status = $("#status2");
    const ducks = document.querySelectorAll(".duck").length;
    const paddles = document.querySelectorAll(".paddle").length;
    const rings = document.querySelectorAll(".ring").length;
    const waves = document.querySelectorAll(".waveSymbol").length;
    const expectedDOM = `${ducks}${paddles}${rings}${waves}`;
    const val = $("#code").value.trim();
    if(val === expectedDOM && val === EXPECTED_CODE){
      solved2 = true; $("#puzzle2").classList.add("solved");
      status.textContent = "Korrekt! âœ…"; status.className = "status ok";
      celebrate(); unlockIfReady();
    }else{
      status.textContent = "Falsch âŒ."; status.className = "status err";
    }
  });

  // R3 â€“ Basel-Reihe
  $("#check3").addEventListener("click", ()=>{
    const status = $("#status3");
    const raw = $("#sumInput").value.trim();
    if(isExactOk(raw) || isNumericOk(raw)){
      solved3 = true; $("#puzzle3").classList.add("solved");
      status.textContent = "Stimmt! ğŸ¥³"; status.className = "status ok";
      celebrate(); unlockIfReady();
    }else{
      status.textContent = "Nein âŒ."; status.className = "status err";
    }
  });
  function isExactOk(s){
    const t = s.toLowerCase().replace(/\s+/g,'').replace(/Ï€/g,'pi');
    return /^\(?pi\^?2\)?\/6$/.test(t) || /^pipi\/6$/.test(t) || /^\(?pi\*pi\)?\/6$/.test(t);
  }
  function isNumericOk(s){
    const n = Number(s.replace(',','.'));
    return Number.isFinite(n) && Math.abs(n - (Math.PI*Math.PI/6)) <= TOL;
  }

  // R4 â€“ Îµâ€“Î´
  $("#check4f").addEventListener("click", ()=>{
    const status = $("#status4");
    const t = $("#deltaFormula").value.trim().toLowerCase().replace(/\s+/g,'').replace(/Î´/g,'delta').replace(/Îµ/g,'epsilon');
    const ok = /(^|=)\(?epsilon\)?\/3$/.test(t) || /(^|=)\(?e\)?\/3$/.test(t);
    if(ok){
      solved4 = true; $("#puzzle4").classList.add("solved");
      status.textContent = "Formel akzeptiert: Î´(Îµ)=Îµ/3 âœ…"; status.className = "status ok";
      celebrate(); unlockIfReady();
    }else{
      status.textContent = "Diese Formel akzeptiere ich hier nicht âŒ."; status.className = "status err";
    }
  });
  $("#check4n").addEventListener("click", ()=>{
    const status = $("#status4");
    const eps = Number($("#epsNum").value.trim().replace(',','.'));
    const del = Number($("#deltaNum").value.trim().replace(',','.'));
    if(!(eps>0 && del>0 && Number.isFinite(eps) && Number.isFinite(del))){
      status.textContent = "UngÃ¼ltige Eingaben âš ï¸."; status.className = "status err"; return;
    }
    if(del <= eps/3 + 1e-12){
      solved4 = true; $("#puzzle4").classList.add("solved");
      status.textContent = "Numerisch ausreichend: Î´ â‰¤ Îµ/3 âœ…"; status.className = "status ok";
      celebrate(); unlockIfReady();
    }else{
      status.textContent = "Zu groÃŸ: FÃ¼r f(x)=3x+1 muss Î´ â‰¤ Îµ/3 gelten âŒ."; status.className = "status err";
    }
  });

  // R5 â€“ Kfz
  $("#check5").addEventListener("click", ()=>{
    const status = $("#status5");
    const choice = document.querySelector('input[name="kfz"]:checked')?.value;
    if(!choice){ status.textContent = "Bitte eine Option wÃ¤hlen ğŸ™."; status.className = "status err"; return; }
    if(choice === "A"){
      solved5 = true; $("#puzzle5").classList.add("solved");
      status.textContent = "Richtig! ğŸš—âœ…"; status.className = "status ok";
      celebrate(); unlockIfReady();
    }else{
      status.textContent = "Falsch âŒ."; status.className = "status err";
    }
  });

  function unlockIfReady(){
    if(solved1 && solved2 && solved3 && solved4 && solved5 && !inserted){
      inserted = true;
      const frag = $("#voucherTpl").content.cloneNode(true);
      const target = $("#voucherContent");
      target.appendChild(frag);
      restoreVoucherValues();
      $("#lock").style.display = "none";
      target.classList.add("show");
      target.setAttribute("aria-hidden","false");
      document.title = "Dommis wunderbare Schlauchboottour ğŸš¤ğŸŒŠ";
      $("#printBtn")?.addEventListener("click", ()=> window.print());
      $("#editBtn")?.addEventListener("click", ()=>{ $("#editor").style.display="block"; fillEditorFromVoucher(); window.scrollTo({top:document.body.scrollHeight,behavior:"smooth"}); });
      $("#cancelBtn")?.addEventListener("click", ()=> { $("#editor").style.display="none"; });
      $("#saveBtn")?.addEventListener("click", saveFromEditor);
      celebrate(260);
    }
  }

  function saveFromEditor(){
    const fields=["datum","uhr","ort","route","dauer","mitbringen","snacks","backup","kontakt"];
    fields.forEach(k=>{
      const src = $("#e_"+k).value || $("#v_"+k).textContent;
      $("#v_"+k).textContent = src;
      localStorage.setItem("v_"+k, src);
    });
    $("#editor")..style.display="none";
  }
  function fillEditorFromVoucher(){
    const fields=["datum","uhr","ort","route","dauer","mitbringen","snacks","backup","kontakt"];
    fields.forEach(k=>{
      const saved = localStorage.getItem("v_"+k);
      const val = saved ?? $("#v_"+k)?.textContent ?? "";
      $("#e_"+k).value = val;
    });
  }
  function restoreVoucherValues(){
    const fields=["datum","uhr","ort","route","dauer","mitbringen","snacks","backup","kontakt"];
    fields.forEach(k=>{
      const saved = localStorage.getItem("v_"+k);
      if(saved && $("#v_"+k)) $("#v_"+k).textContent = saved;
    });
  }

  // Konfetti ğŸŠ
  const canvas=$("#confetti"), ctx=canvas.getContext("2d"); let confetti=[];
  function resize(){ canvas.width=innerWidth; canvas.height=innerHeight; }
  window.addEventListener("resize",resize); resize();
  function makePiece(){ return {x:Math.random()*canvas.width,y:-20,r:6+Math.random()*8,vx:-2+Math.random()*4,vy:2+Math.random()*3,rot:Math.random()*Math.PI,vr:-0.2+Math.random()*0.4,ttl:120+Math.random()*120,hue:Math.floor(180+Math.random()*160)}}
  function celebrate(count=180){ for(let i=0;i<count;i++) confetti.push(makePiece()); }
  function tick(){ ctx.clearRect(0,0,canvas.width,canvas.height); confetti=confetti.filter(p=>p.ttl>0);
    confetti.forEach(p=>{p.ttl--;p.x+=p.vx;p.y+=p.vy;p.rot+=p.vr;ctx.save();ctx.translate(p.x,p.y);ctx.rotate(p.rot);ctx.fillStyle=`hsl(${p.hue} 80% 60%)`;ctx.fillRect(-p.r/2,-p.r/2,p.r,p.r);ctx.restore();});
    requestAnimationFrame(tick);}
  tick();
})();
</script>
</body>
</html>
